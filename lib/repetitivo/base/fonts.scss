@import "../config/fonts";

@import "../functions/last";

@each $font in $fonts {
  $font: nth($font, 1);

  @font-face {
    $sources: "";
    $files: map-get($font, files);
    font-family: map-get($font, family);

    @for $i from 1 through length($files) {
      $file: nth($files, $i);

      // Use explicit formats if they are defined in the config
      // Use file extension otherwise
      $formats: map-get($font, formats);

      @if $formats {
        $format: nth($formats, $i);
      } @else {
        $format: last(str-split($file, "."));
      }

      $sources: "#{$sources}, url(\"#{$file}\") format(\"#{$format}\")";
    }

    src: #{str-slice($sources, 3)}; // Remove leading comma and space

    @if map-has-key($font, weight) {
      font-weight: map-get($font, weight);
    }

    @if map-has-key($font, style) {
      font-style: map-get($font, style);
    }
  }
}
